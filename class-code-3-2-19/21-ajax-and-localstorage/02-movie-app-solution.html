<!DOCTYPE html>
<html>
<head>
	<title></title>
	<style type="text/css">
		.hidden {
			display: none;
		}
	</style>
</head>
<body>
<!-- 
the default attributes are this
<form method="GET" action="/"> -->
<form>
	<input type="text" placeholder="write a movie name">
	<button>add a movie</button>
</form>

<div id="movieButtons">
	
</div>

<div id="movieInfo" class="hidden">
	<p>Rating: <span id="rating"></span></p>
	<p>Released: <span id="released"></span></p>
	<p>Plot: <span id="plot"></span></p>
	<p><img src=""></p>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

<script type="text/javascript">
	var movieList = ["The Matrix", "The Notebook", "Mr. Nobody", "The Lion King"];

	for (var i=0; i<movieList.length; i++){
		var button = $('<button>'); 
			//var button looks like this now: <button></button> 
				//THIS IS NOT ON THE PAGE YET

		button.text(movieList[i]);
			//var button looks like this now: <button>The Matrix</button> 
				//THIS IS NOT ON THE PAGE YET

		$('#movieButtons').append(button);
			//now the button is on the page

	}

	// <form>
	// 	<input type="text" placeholder="write a movie name">
	// 	<button>add a movie</button>
	// </form>

	$('form button').on('click', function(){
		event.preventDefault();
		var button = $('<button>'); 
			//var button looks like this now: <button></button> 
				//THIS IS NOT ON THE PAGE YET

		var movieText = $('input').val();

		button.text(movieText);
		
		movieList.push(movieText)

		$('#movieButtons').append(button);
	});

	// 1. go over document on click
	// 2. go over $(this)

	//works for buttons that were already added to the page
		// $('button').on('click', function(){

	//works with new buttons because the click event is attached to the document and the document is always there
	$(document).on('click', '#movieButtons button',function(){

		debugger;

		// this.text()
			// VM271:1 Uncaught TypeError: this.text is not a function

		//how do I get this assigned to the button
			// because I clicked on that button 
				//this is the button we clicked on 

		var movie = $(this).text();
		var qurl = "https://www.omdbapi.com/?t=" + movie + "&y=&plot=short&apikey=trilogy";

		$.ajax({
			url: qurl,
			method: 'GET'
		}).then(function(data){
			console.log(data);

			$('#rating').text(data.Rated);
			$('#released').text(data.Released);
			$('#plot').text(data.Plot);
			$('img').attr('src', data.Poster);

			$('#movieInfo').removeClass('hidden');
		});
	})
	

</script>

</body>
</html>